package tests;

import base.BaseTest;
import org.testng.Assert;
import org.testng.annotations.Test;
import pages.*;
import utils.ConfigReader;

public class E2ECheckoutTest extends BaseTest {

    @Test
    public void verifyEndToEndCheckoutFlow() {

        // Navigate to URL
        driver.get(ConfigReader.get("baseUrl"));

        // Create page objects
        LoginPage loginPage = new LoginPage(driver);
        InventoryPage inventoryPage;
        ProductPage productPage;
        CartPage cartPage;
        CheckoutPage checkoutPage;
        CheckoutOverviewPage overviewPage;
        CheckoutCompletePage completePage;

        // 1. LOGIN
        inventoryPage = loginPage.loginAs(
                ConfigReader.get("username"),
                ConfigReader.get("password")
        );

        // 2. CLICK FIRST PRODUCT
        productPage = inventoryPage.clickFirstProduct();

        // 3. ADD TO CART
        productPage.addToCart();

        // 4. GO TO CART
        cartPage = productPage.goToCart();

        // 5. CLICK CHECKOUT
        checkoutPage = cartPage.clickCheckout();

        // 6. ENTER USER DETAILS
        checkoutPage.fillInformation("John", "Doe", "12345");

        // 7. CONTINUE TO OVERVIEW
        overviewPage = checkoutPage.clickContinue();

        // 8. FINISH ORDER
        completePage = overviewPage.clickFinish();

        // 9. VALIDATE SUCCESS MESSAGE
        String successMessage = completePage.getSuccessMessage();

        Assert.assertEquals(
                successMessage.trim(), 
                "Thank you for your order!",
                "Order success message did not match!"
        );

        System.out.println("E2ECheckoutTest executed successfully!");
    }
}
